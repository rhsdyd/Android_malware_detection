import pandas as pd
import numpy as np

def df_split(data, label, num):
    pointer = round(len(data.columns) / num)

    result = []

    for i in range(0, num):
        if i + 1 != num:
            fraction = pd.concat([label, data.iloc[:, pointer * i: pointer * (i + 1)]], axis=1)
        else:
            fraction = pd.concat([label, data.iloc[:, pointer * i:]], axis=1)

        result.append(fraction)

    return result

def chunk_read(name, db):
    mat_name = name + 'VectorMatrix'
    n_records = db.get_collection(mat_name).find().count()
    df_list = []
    for i in range(0, n_records, 10):
        df = pd.DataFrame(list(db.get_collection(mat_name).find().skip(i).limit(10)))
        df_list.append(df)
    return pd.concat(df_list)