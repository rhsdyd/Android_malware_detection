# Android_malware_detection
This is a tool for android malware detection with following functions:
1. Static Features extraction from Android APK
2. Turn extracted features to Binary-vector matrix
3. Compare various feature selection algorithms and machine learning algorithms
4. Generate the classifier model with the best combination of feature selection and machine learning

### APK collection
Source: [AndroZoo](https://androzoo.uni.lu/)
- List of APKs (CSV file Androzoo): 
    - vt_detection (column) : The number of AV(Anti-Virus) from VirusTotal (VT) that detected this apks as a malware 
    - if vt_detection = 0 : Benign
    - if vt_detection > 0 : Malware
- Bulk download of APKs via API : [azoo](https://github.com/ArtemKushnerov/az)

## Static Feature Extraction
we need Reversing Engineering techniques for Static analysis.
For that, [Androguard](https://androguard.readthedocs.io/en/latest/) is used.

Categories of Features:
- AndroidManifest.xml
    - Permissions
    - Activities
    - Services
    - Receivers
- decompiled DEX to Java
    - Java Classes of API Call
    - Java Methods of API Call

Output:
Output can be a CSV file and forwarded to MySQL Database
Output table structur
- App name : the name of APK name
- Label : either Benign or Malware
- feature : Json of feature sets

###How to use
For further steps, Source file for APK have to follow this structure.
```
- source 
    ├── benign        # Benigh APKs
    ├── malware       # Malware APKs

```
####Local environment
PREREQUISITES
- Python 3.6 or newer
- MySQL  5.7 or newer

    ```sh
    $ python feature_extraction.py <Arguemtns>
    ```
There are different arguments
* `-h`: Show the help message and exit.
* `-S`, `--source`: directory of source file(e.g., /DIR/source)
* `-db`, `--database`: boolean / whether use MySQL or not (optional)

Example: `$ python feature_extraction.py -s /DIR/source -db`

SQL connection information(**db.py**)
   ```    
    db = pymysql.connect(
            user='USER_NAME',
            passwd='PASSWORD',
            host='HOST_NAME',
            db='DATABASE',
            port=PORT_NUMBER
        )
   ```



####Docker
Note: source file has to be in this application directory.
1. to build and start the containers 
    ```    
     $ docker-compose up -d --build
    ```
2. RUN
    ```
     $ docker-compose run appDetector python feature_extraction.py -s <source_file_name> -db
    ```